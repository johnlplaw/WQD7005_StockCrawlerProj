**********************************************************;
**** Begin scoring code for principal components analysis;
**********************************************************;
LENGTH _FORMAT $200;
LENGTH _NORMFMT $%DMNORLEN;
;
/************************************************/
* Impute missing values for interval variables;
/************************************************/
;
if buyval=. then _D1 = 0;
else _D1=(buyval-13550.9536299499)/89723.449904709;
if chg=. then _D2 = 0;
else _D2=(chg-0.00593730339964)/0.01402794838285;
if downcnt=. then _D3 = 0;
else _D3=(downcnt-15.4404404404404)/10.946591338406;
if downpricesum=. then _D4 = 0;
else _D4=(downpricesum-0.41546546546546)/1.05917941380098;
if high=. then _D5 = 0;
else _D5=(high-1.48120177913346)/5.94341977146135;
if lastDone=. then _D6 = 0;
else _D6=(lastDone-1.63920565459666)/6.00631668697012;
if low=. then _D7 = 0;
else _D7=(low-1.45505365167219)/5.88038609965592;
if open=. then _D8 = 0;
else _D8=(open-1.46803728165452)/5.91312329376146;
if sellVal=. then _D9 = 0;
else _D9=(sellVal-7801.77002866673)/40321.4191220332;
if unchgcnt=. then _D10 = 0;
else _D10=(unchgcnt-17.082082082082)/9.47030319231533;
if upcnt=. then _D11 = 0;
else _D11=(upcnt-28.2582582582582)/12.129700269447;
if uppricesum=. then _D12 = 0;
else _D12=(uppricesum-10.710055055055)/45.0831781769102;
if vol=. then _D13 = 0;
else _D13=(vol-20079.7904259297)/72911.5539700116;
/****************************************/
* Principal Component 1;
/****************************************/
;
label PC_1 = "Principal Component 1";
PC_1 =
-0.03296009*_D1+
0.3901494046*_D2+
0.1279075281*_D3+
0.3943197458*_D4+
0.4069287077*_D5+
0.404315916*_D6+
0.4066766738*_D7+
0.4068114795*_D8+
-0.036953276*_D9+
-0.103889225*_D10+
-0.033113006*_D11+
0.0405245418*_D12+
-0.002760747*_D13;
/****************************************/
* Principal Component 2;
/****************************************/
;
label PC_2 = "Principal Component 2";
PC_2 =
0.506211409*_D1+
0.008589787*_D2+
0.1995980467*_D3+
0.0376934032*_D4+
0.0199943257*_D5+
-0.006269401*_D6+
0.0198736034*_D7+
0.019978002*_D8+
0.5202068389*_D9+
0.3371749078*_D10+
-0.441180429*_D11+
-0.208582243*_D12+
0.2805959661*_D13;
/****************************************/
* Principal Component 3;
/****************************************/
;
label PC_3 = "Principal Component 3";
PC_3 =
0.3828532562*_D1+
0.0141173842*_D2+
-0.581135599*_D3+
-0.05892999*_D4+
0.0684378985*_D5+
0.1099829438*_D6+
0.0694733577*_D7+
0.0688635745*_D8+
0.3759478874*_D9+
0.0869299193*_D10+
0.4559657662*_D11+
0.3406316559*_D12+
-0.113382944*_D13;
/****************************************/
* Principal Component 4;
/****************************************/
;
label PC_4 = "Principal Component 4";
PC_4 =
0.1588083642*_D1+
0.0120176504*_D2+
0.2642934255*_D3+
0.0429445933*_D4+
-0.070690592*_D5+
-0.05271125*_D6+
-0.07185793*_D7+
-0.071261988*_D8+
0.1682729957*_D9+
-0.666775421*_D10+
0.2760555711*_D11+
0.1415842814*_D12+
0.5619294504*_D13;
/****************************************/
* Principal Component 5;
/****************************************/
;
label PC_5 = "Principal Component 5";
PC_5 =
-0.128741293*_D1+
-0.051612626*_D2+
0.1208934503*_D3+
-0.083067728*_D4+
-0.020385888*_D5+
0.0863016873*_D6+
-0.019299292*_D7+
-0.01984605*_D8+
-0.107011314*_D9+
0.2439986617*_D10+
-0.297486825*_D11+
0.8566328069*_D12+
0.2393982112*_D13;
/****************************************/
* Principal Component 6;
/****************************************/
;
label PC_6 = "Principal Component 6";
PC_6 =
-0.270804669*_D1+
0.0072493827*_D2+
-0.403871*_D3+
-0.058790819*_D4+
0.0727600275*_D5+
0.0399826911*_D6+
0.0736172292*_D7+
0.0730809341*_D8+
-0.178269956*_D9+
0.3109417772*_D10+
0.1245672457*_D11+
-0.259178455*_D12+
0.7288592047*_D13;
/****************************************/
* Principal Component 7;
/****************************************/
;
label PC_7 = "Principal Component 7";
PC_7 =
-0.009417518*_D1+
0.7388662797*_D2+
-0.120030121*_D3+
0.3931600262*_D4+
-0.256412675*_D5+
-0.250071447*_D6+
-0.264538191*_D7+
-0.260555313*_D8+
-0.013468977*_D9+
0.1180239508*_D10+
0.0039479416*_D11+
0.0668686089*_D12+
0.0159723952*_D13;
/****************************************/
* Principal Component 8;
/****************************************/
;
label PC_8 = "Principal Component 8";
PC_8 =
0.6932993414*_D1+
0.0161931241*_D2+
-0.012743238*_D3+
-0.035858427*_D4+
0.0054443575*_D5+
0.0044861298*_D6+
0.0057532404*_D7+
0.005541379*_D8+
-0.71666776*_D9+
0.0220706687*_D10+
0.0002556866*_D11+
-0.008450501*_D12+
0.0577991894*_D13;
;
DROP _FORMAT _NORMFMT
_D1
_D2
_D3
_D4
_D5
_D6
_D7
_D8
_D9
_D10
_D11
_D12
_D13
;
